_G.SpooferSettings = {
    DisplayName = {
        Enabled = false,      
        Value = "grabis"    
    },
    UserName = {
        Enabled = false,     
        Value = "grabis_user" 
    }
}

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local CoreGui = gethui and gethui() or game:GetService("CoreGui")
local LocalPlayer = Players.LocalPlayer

local RealName = LocalPlayer.Name
local RealDisplayName = LocalPlayer.DisplayName

local OldIndex
OldIndex = hookmetamethod(game, "__index", newcclosure(function(self, key)
    if not checkcaller() and self == LocalPlayer then
        
        if key == "DisplayName" and _G.SpooferSettings.DisplayName.Enabled then
            return _G.SpooferSettings.DisplayName.Value
        end

        if key == "Name" and _G.SpooferSettings.UserName.Enabled then
            return _G.SpooferSettings.UserName.Value
        end
    end

    return OldIndex(self, key)
end))

local function updateTextObject(obj)
    if not obj or not obj.Parent then return end
    
    if obj:IsA("TextLabel") or obj:IsA("TextButton") or obj:IsA("TextBox") then
        
        if not _G.SpooferSettings.DisplayName.Enabled and not _G.SpooferSettings.UserName.Enabled then
            return
        end

        local text = obj.Text
        local newText = text
        local changed = false

        if _G.SpooferSettings.DisplayName.Enabled then
            if text:find(RealDisplayName) then
                newText = newText:gsub(RealDisplayName, _G.SpooferSettings.DisplayName.Value)
                changed = true
            end
        end

        if _G.SpooferSettings.UserName.Enabled then
            if text:find(RealName) then
                newText = newText:gsub(RealName, _G.SpooferSettings.UserName.Value)
                changed = true
            end
        end

        if changed then
            pcall(function()
                obj.Text = newText
            end)
            
            if not obj:GetAttribute("SpoofConnection") then
                obj:SetAttribute("SpoofConnection", true)
                obj:GetPropertyChangedSignal("Text"):Connect(function()
                    updateTextObject(obj) 
                end)
            end
        end
    end
end

local function scanHierarchy(parent)
    for _, child in pairs(parent:GetDescendants()) do
        updateTextObject(child)
    end
    
    parent.DescendantAdded:Connect(function(child)
        RunService.RenderStepped:Wait()
        updateTextObject(child)
    end)
end

task.spawn(function()
    scanHierarchy(CoreGui) -- Интерфейс Роблокса (чат, таб)
    scanHierarchy(LocalPlayer:WaitForChild("PlayerGui")) -- Интерфейс игры
    
    while task.wait(1) do
        if _G.SpooferSettings.DisplayName.Enabled and LocalPlayer.Character then
            local hum = LocalPlayer.Character:FindFirstChild("Humanoid")
            if hum and hum.DisplayName ~= _G.SpooferSettings.DisplayName.Value then
                hum.DisplayName = _G.SpooferSettings.DisplayName.Value
            end
        end
    end
end)
